const t={name:"windy-plugin-knmi-qg-regions",version:"0.2.2",icon:"â˜€",title:"KNMI Solar Radiation",description:"Overlay KNMI 10 minute irradiance (qg) averaged per Dutch region.",author:"Artis Byte",repository:"https://github.com/artis-byte/NL-solar",desktopUI:"rhpane",mobileUI:"fullscreen",routerPath:"/knmi-solar",private:!1,built:1760117994641,builtReadable:"2025-10-10T17:39:54.641Z",screenshot:"screenshot.jpg"};function e(){}function n(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(n)}function l(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(t,e){t.appendChild(e)}function c(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=d("style");t.id=e,t.textContent=n,function(t,e){u(t.head||t,e),e.sheet}(o,t)}}function s(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function h(){return m(" ")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function b(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}let y;function _(t){y=t}function w(){if(!y)throw new Error("Function called outside component initialization");return y}const x=[],N=[];let E=[];const k=[],F=Promise.resolve();let I=!1;function M(t){E.push(t)}const O=new Set;let S=0;function D(){if(0!==S)return;const t=y;do{try{for(;S<x.length;){const t=x[S];S++,_(t),L(t.$$)}}catch(t){throw x.length=0,S=0,t}for(_(null),x.length=0,S=0;N.length;)N.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];O.has(e)||(O.add(e),e())}E.length=0}while(x.length);for(;k.length;)k.pop()();I=!1,O.clear(),_(t)}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const C=new Set;function q(t){return void 0!==t?.length?t:Array.from(t)}function A(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];E.forEach(o=>-1===t.indexOf(o)?e.push(o):n.push(o)),n.forEach(t=>t()),E=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function j(t,e){-1===t.$$.dirty[0]&&(x.push(t),I||(I=!0,F.then(D)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(t,i,u,c,s,f,d=null,m=[-1]){const h=y;_(t);const g=t.$$={fragment:null,ctx:[],props:f,update:e,not_equal:s,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(h?h.$$.context:[])),callbacks:o(),dirty:m,skip_bound:!1,root:i.target||h.$$.root};d&&d(g.root);let p=!1;if(g.ctx=u?u(t,i.props||{},(e,n,...o)=>{const r=o.length?o[0]:n;return g.ctx&&s(g.ctx[e],g.ctx[e]=r)&&(!g.skip_bound&&g.bound[e]&&g.bound[e](r),p&&j(t,e)),n}):[],g.update(),p=!0,r(g.before_update),g.fragment=!!c&&c(g.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);g.fragment&&g.fragment.l(t),t.forEach(a)}else g.fragment&&g.fragment.c();i.intro&&((v=t.$$.fragment)&&v.i&&(C.delete(v),v.i($))),function(t,e,o){const{fragment:i,after_update:u}=t.$$;i&&i.m(e,o),M(()=>{const e=t.$$.on_mount.map(n).filter(l);t.$$.on_destroy?t.$$.on_destroy.push(...e):r(e),t.$$.on_mount=[]}),u.forEach(M)}(t,i.target,i.anchor),D()}var v,$;_(h)}class z{$$=void 0;$$set=void 0;$destroy(){A(this,1),this.$destroy=e}$on(t,n){if(!l(n))return e;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(t){c(t,"svelte-19uuc02","section.svelte-19uuc02{padding:0.75em;max-width:320px;font-family:sans-serif;font-size:0.9em;line-height:1.4}h1.svelte-19uuc02{font-size:1.2em;margin:0 0 0.4em}p.intro.svelte-19uuc02{margin:0 0 0.75em}label.svelte-19uuc02{display:block;margin:0.75em 0 0.25em;font-weight:600}select.svelte-19uuc02{width:100%;padding:0.3em;margin-top:0.25em}.status.svelte-19uuc02{margin:0.75em 0 0}.status.error.svelte-19uuc02{color:#b03a2e}.legend.svelte-19uuc02{margin-top:1em;border-top:1px solid #dddddd;padding-top:0.75em}.legend-title.svelte-19uuc02{font-weight:600;margin-bottom:0.4em}.legend-row.svelte-19uuc02{display:flex;align-items:center;margin-bottom:0.25em}.legend-swatch.svelte-19uuc02{width:18px;height:12px;margin-right:0.5em;border:1px solid #333333;box-sizing:border-box}.footer.svelte-19uuc02{margin-top:1em;font-size:0.8em;color:#555555}a.svelte-19uuc02{color:#0066cc}")}function K(t,e,n){const o=t.slice();return o[29]=e[n],o}function P(t,e,n){const o=t.slice();return o[32]=e[n],o}function T(t){let e,n,o,l,i,u=q(t[5]),c=[];for(let e=0;e<u.length;e+=1)c[e]=W(P(t,u,e));return{c(){e=d("label"),e.textContent="Metric",n=h(),o=d("select");for(let t=0;t<c.length;t+=1)c[t].c();p(e,"for","metric-select"),p(e,"class","svelte-19uuc02"),p(o,"id","metric-select"),p(o,"class","svelte-19uuc02"),void 0===t[3]&&M(()=>t[9].call(o))},m(r,u){s(r,e,u),s(r,n,u),s(r,o,u);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(o,null);b(o,t[3],!0),l||(i=[g(o,"change",t[8]),g(o,"change",t[9])],l=!0)},p(t,e){if(48&e[0]){let n;for(u=q(t[5]),n=0;n<u.length;n+=1){const r=P(t,u,n);c[n]?c[n].p(r,e):(c[n]=W(r),c[n].c(),c[n].m(o,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=u.length}40&e[0]&&b(o,t[3])},d(t){t&&(a(e),a(n),a(o)),f(c,t),l=!1,r(i)}}}function W(t){let e,n,o,r=t[4][t[32]].label+"";return{c(){e=d("option"),n=m(r),e.__value=o=t[32],$(e,e.__value)},m(t,o){s(t,e,o),u(e,n)},p(t,l){48&l[0]&&r!==(r=t[4][t[32]].label+"")&&v(n,r),32&l[0]&&o!==(o=t[32])&&(e.__value=o,$(e,e.__value))},d(t){t&&a(e)}}}function J(t){let e,n,o,r=et(t[2])+"";return{c(){e=d("p"),n=m("Last refreshed: "),o=m(r),p(e,"class","status svelte-19uuc02")},m(t,r){s(t,e,r),u(e,n),u(e,o)},p(t,e){4&e[0]&&r!==(r=et(t[2])+"")&&v(o,r)},d(t){t&&a(e)}}}function G(t){let e,n,o;return{c(){e=d("p"),n=m("Failed to load data: "),o=m(t[1]),p(e,"class","status error svelte-19uuc02")},m(t,r){s(t,e,r),u(e,n),u(e,o)},p(t,e){2&e[0]&&v(o,t[1])},d(t){t&&a(e)}}}function H(t){let n;return{c(){n=d("p"),n.textContent="Loading latest data...",p(n,"class","status svelte-19uuc02")},m(t,e){s(t,n,e)},p:e,d(t){t&&a(n)}}}function U(t){let e,n,o,r,l,i=t[7]?" ("+t[7]+")":"",c=q(t[6]),g=[];for(let e=0;e<c.length;e+=1)g[e]=Z(K(t,c,e));return{c(){e=d("div"),n=d("div"),o=m("Legend"),r=m(i),l=h();for(let t=0;t<g.length;t+=1)g[t].c();p(n,"class","legend-title svelte-19uuc02"),p(e,"class","legend svelte-19uuc02")},m(t,i){s(t,e,i),u(e,n),u(n,o),u(n,r),u(e,l);for(let t=0;t<g.length;t+=1)g[t]&&g[t].m(e,null)},p(t,n){if(128&n[0]&&i!==(i=t[7]?" ("+t[7]+")":"")&&v(r,i),64&n[0]){let o;for(c=q(t[6]),o=0;o<c.length;o+=1){const r=K(t,c,o);g[o]?g[o].p(r,n):(g[o]=Z(r),g[o].c(),g[o].m(e,null))}for(;o<g.length;o+=1)g[o].d(1);g.length=c.length}},d(t){t&&a(e),f(g,t)}}}function V(t){let e,n,o,r,l,i,c,f=t[29].label+"";return{c(){e=d("div"),n=d("span"),r=h(),l=d("span"),i=m(f),c=h(),p(n,"class","legend-swatch svelte-19uuc02"),p(n,"style",o=`background:${t[29].color}`),p(e,"class","legend-row svelte-19uuc02")},m(t,o){s(t,e,o),u(e,n),u(e,r),u(e,l),u(l,i),u(e,c)},p(t,e){64&e[0]&&o!==(o=`background:${t[29].color}`)&&p(n,"style",o),64&e[0]&&f!==(f=t[29].label+"")&&v(i,f)},d(t){t&&a(e)}}}function Z(t){let e,n=t[29].label&&V(t);return{c(){n&&n.c(),e=m("")},m(t,o){n&&n.m(t,o),s(t,e,o)},p(t,o){t[29].label?n?n.p(t,o):(n=V(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){t&&a(e),n&&n.d(t)}}}function Q(t){let n,o,r,l,i,c,f,g,v,$,b,y,_,w=t[5].length&&T(t);function x(t,e){return t[0]?H:t[1]?G:t[2]?J:void 0}let N=x(t),E=N&&N(t),k=t[6].length&&U(t);return{c(){n=d("section"),o=d("h1"),o.textContent="KNMI Solar Radiation",r=h(),l=d("p"),l.textContent="Overlay KNMI 10 minute irradiance averaged per Dutch region.",i=h(),w&&w.c(),c=h(),E&&E.c(),f=h(),k&&k.c(),g=h(),v=d("p"),$=m("Source: "),b=d("a"),y=m("GeoJSON feed"),_=m(". Data refreshes every 10 minutes."),p(o,"class","svelte-19uuc02"),p(l,"class","intro svelte-19uuc02"),p(b,"href",X),p(b,"target","_blank"),p(b,"rel","noopener"),p(b,"class","svelte-19uuc02"),p(v,"class","footer svelte-19uuc02"),p(n,"class","svelte-19uuc02")},m(t,e){s(t,n,e),u(n,o),u(n,r),u(n,l),u(n,i),w&&w.m(n,null),u(n,c),E&&E.m(n,null),u(n,f),k&&k.m(n,null),u(n,g),u(n,v),u(v,$),u(v,b),u(b,y),u(v,_)},p(t,e){t[5].length?w?w.p(t,e):(w=T(t),w.c(),w.m(n,c)):w&&(w.d(1),w=null),N===(N=x(t))&&E?E.p(t,e):(E&&E.d(1),E=N&&N(t),E&&(E.c(),E.m(n,f))),t[6].length?k?k.p(t,e):(k=U(t),k.c(),k.m(n,g)):k&&(k.d(1),k=null)},i:e,o:e,d(t){t&&a(n),w&&w.d(),E&&E.d(),k&&k.d()}}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const X="https://raw.githubusercontent.com/artis-byte/NL-solar/main/qg_regions.geojson",Y="qg_mean";function tt(t){if("number"!=typeof t||!Number.isFinite(t))return"n/a";const e=Math.abs(t);return e>=1e3||e>=100?t.toFixed(0):e>=10?t.toFixed(1):e>=1?t.toFixed(2):0===e?"0":t.toPrecision(2)}function et(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function nt(t,e,n){const o=["#800026","#BD0026","#E31A1C","#FC4E2A","#FD8D3C","#FEB24C","#FED976","#FFEDA0"],r={qg_mean:"Mean global irradiance (qg)",estimated_output_mw:"Estimated PV output",solar_capacity_mw:"Installed solar capacity"},l={qg_mean:"W/m^2",estimated_output_mw:"MW",solar_capacity_mw:"MW"};let i=null,u=null,c=null,s=null,a=null,f=!1,d="",m="",h=Y,g={},p=[],v=[],$="",b=null;function y(){const t=function(){const t="undefined"!=typeof window?window.W:null;return t&&t.map?t.map:null}();return!!t&&(i=t,!0)}function _(){return u||"undefined"==typeof window||(u=window.L||null),u}function x(t,e){if("qg_mean"===t)return[800,600,400,200,100,50,10];const n=o.length-1,r=e.min,l=e.max;if(!Number.isFinite(r)||!Number.isFinite(l)||l<=r)return[];const i=l-r,u=[];for(let t=n;t>=1;t-=1)u.push(r+i*t/n);return u}function N(t,e){if("number"!=typeof t||!Number.isFinite(t))return"#7f7f7f";if(!e.length)return o[Math.floor(o.length/2)];for(let n=0;n<e.length;n+=1)if(t>=e[n])return o[n];return o[o.length-1]}function E(){c&&i&&(i.removeLayer(c),c=null)}function k(t){if(!t)return void E();const e=g[h];if(!e)return n(1,d="No numeric metric found in dataset."),void E();const u=_();if(!u)return n(1,d="Leaflet library is not available in Windy."),void E();y()&&(E(),n(6,v=function(t,e){const n=[],r=l[e]||"";for(let e=0;e<o.length;e+=1){let l;l=t.length?0===e?`>= ${tt(t[0])}`:e===o.length-1?`< ${tt(t[t.length-1])}`:`${tt(t[e-1])} - ${tt(t[e])}`:0===e?"Higher values":e===o.length-1?"Lower values":"",r&&l&&"Higher values"!==l&&"Lower values"!==l&&(l=`${l} ${r}`),n.push({color:o[e],label:l})}return n}(e.thresholds,h)),n(7,$=e.units||""),c=u.geoJSON(t,{style:t=>({fillColor:N((t?.properties||{})[h],e.thresholds),fillOpacity:.6,weight:1,color:"#333333"}),onEachFeature:(t,e)=>{const n=function(t){const e=t?.properties||{},n=[],o=e.name||e.station||"Region";n.push(`<strong>${o}</strong>`);const i=g[h];if(i){const t=e[h],o=i.units?` ${i.units}`:"";n.push(`${i.label}: ${tt(t)}${o}`)}const u=["estimated_output_mw","solar_capacity_mw"];for(const t of u){if(t===h)continue;const o=e[t];if("number"==typeof o&&Number.isFinite(o)){const e=l[t]?` ${l[t]}`:"",i=r[t]||t;n.push(`${i}: ${tt(o)}${e}`)}}return n.join("<br>")}(t);n&&e.bindPopup(n)}}).addTo(i))}async function F(){n(0,f=!0),n(1,d="");try{const t=await fetch(`${X}?t=${Date.now()}`,{cache:"no-store"});if(!t.ok)throw new Error(`Request failed (${t.status})`);const e=await t.json();if(b=e,n(4,g=function(t){const e=Array.isArray(t?.features)?t.features:[],n={};for(const t of e){const e=t&&t.properties;if(e)for(const[t,o]of Object.entries(e))"number"==typeof o&&Number.isFinite(o)&&"level"!==t&&(n[t]||(n[t]=[]),n[t].push(o))}const o={};for(const[t,e]of Object.entries(n)){if(!e.length)continue;const n=e.reduce((t,e)=>Math.min(t,e),e[0]),i=e.reduce((t,e)=>Math.max(t,e),e[0]);o[t]={key:t,label:r[t]||t,units:l[t]||"",min:n,max:i,thresholds:x(t,{min:n,max:i})}}return o}(e)),n(5,p=Object.keys(g)),!p.length)throw new Error("GeoJSON does not contain numeric metrics.");g[h]||n(3,h=g[Y]?Y:p[0]),k(e),n(2,m=(new Date).toISOString())}catch(t){console.error("Failed to load KNMI data",t),n(1,d=t?.message||String(t)),b=null,n(4,g={}),n(5,p=[]),n(6,v=[]),n(7,$=""),E()}finally{n(0,f=!1)}}var I;return I=()=>{_(),y(),F(),s=setInterval(F,6e5),a||(a=setInterval(()=>{!i&&y()&&b&&(k(b),clearInterval(a),a=null)},1e3))},w().$$.on_mount.push(I),function(t){w().$$.on_destroy.push(t)}(()=>{s&&(clearInterval(s),s=null),a&&(clearInterval(a),a=null),E()}),[f,d,m,h,g,p,v,$,function(t){n(3,h=t.currentTarget.value),k(b)},function(){h=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(3,h),n(5,p)}]}class ot extends z{constructor(t){super(),R(this,t,nt,Q,i,{},B,[-1,-1])}}export{t as __pluginConfig,ot as default};
