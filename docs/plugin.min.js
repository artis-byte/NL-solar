const t={name:"windy-plugin-knmi-qg-regions",version:"0.2.4",icon:"â˜€",title:"KNMI Solar Radiation",description:"Overlay KNMI 10 minute irradiance (qg) averaged per Dutch region.",author:"Artis Byte",repository:"https://github.com/artis-byte/NL-solar",desktopUI:"rhpane",mobileUI:"fullscreen",routerPath:"/knmi-solar",private:!1,built:1760118838216,builtReadable:"2025-10-10T17:53:58.216Z",screenshot:"screenshot.jpg"},{map:e}=W.map;function n(){}function o(t){return t()}function r(){return Object.create(null)}function l(t){t.forEach(o)}function i(t){return"function"==typeof t}function u(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function s(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=m("style");t.id=e,t.textContent=n,function(t,e){c(t.head||t,e),e.sheet}(o,t)}}function a(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function p(){return h(" ")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}function y(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}let _;function w(t){_=t}function x(){if(!_)throw new Error("Function called outside component initialization");return _}const N=[],E=[];let k=[];const F=[],L=Promise.resolve();let I=!1;function M(t){k.push(t)}const O=new Set;let S=0;function D(){if(0!==S)return;const t=_;do{try{for(;S<N.length;){const t=N[S];S++,w(t),C(t.$$)}}catch(t){throw N.length=0,S=0,t}for(w(null),N.length=0,S=0;E.length;)E.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];O.has(e)||(O.add(e),e())}k.length=0}while(N.length);for(;F.length;)F.pop()();I=!1,O.clear(),w(t)}function C(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const q=new Set;function A(t){return void 0!==t?.length?t:Array.from(t)}function j(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];k.forEach(o=>-1===t.indexOf(o)?e.push(o):n.push(o)),n.forEach(t=>t()),k=e}(n.after_update),l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(N.push(t),I||(I=!0,L.then(D)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function T(t,e,u,c,s,a,d=null,m=[-1]){const h=_;w(t);const p=t.$$={fragment:null,ctx:[],props:a,update:n,not_equal:s,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:r(),dirty:m,skip_bound:!1,root:e.target||h.$$.root};d&&d(p.root);let g=!1;if(p.ctx=u?u(t,e.props||{},(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&s(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),g&&R(t,e)),n}):[],p.update(),g=!0,l(p.before_update),p.fragment=!!c&&c(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();e.intro&&((v=t.$$.fragment)&&v.i&&(q.delete(v),v.i($))),function(t,e,n){const{fragment:r,after_update:u}=t.$$;r&&r.m(e,n),M(()=>{const e=t.$$.on_mount.map(o).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...e):l(e),t.$$.on_mount=[]}),u.forEach(M)}(t,e.target,e.anchor),D()}var v,$;w(h)}class z{$$=void 0;$$set=void 0;$destroy(){j(this,1),this.$destroy=n}$on(t,e){if(!i(e))return n;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(t){s(t,"svelte-19uuc02","section.svelte-19uuc02{padding:0.75em;max-width:320px;font-family:sans-serif;font-size:0.9em;line-height:1.4}h1.svelte-19uuc02{font-size:1.2em;margin:0 0 0.4em}p.intro.svelte-19uuc02{margin:0 0 0.75em}label.svelte-19uuc02{display:block;margin:0.75em 0 0.25em;font-weight:600}select.svelte-19uuc02{width:100%;padding:0.3em;margin-top:0.25em}.status.svelte-19uuc02{margin:0.75em 0 0}.status.error.svelte-19uuc02{color:#b03a2e}.legend.svelte-19uuc02{margin-top:1em;border-top:1px solid #dddddd;padding-top:0.75em}.legend-title.svelte-19uuc02{font-weight:600;margin-bottom:0.4em}.legend-row.svelte-19uuc02{display:flex;align-items:center;margin-bottom:0.25em}.legend-swatch.svelte-19uuc02{width:18px;height:12px;margin-right:0.5em;border:1px solid #333333;box-sizing:border-box}.footer.svelte-19uuc02{margin-top:1em;font-size:0.8em;color:#555555}a.svelte-19uuc02{color:#0066cc}")}function K(t,e,n){const o=t.slice();return o[30]=e[n],o}function P(t,e,n){const o=t.slice();return o[33]=e[n],o}function J(t){let e,n,o,r,i,u=A(t[5]),c=[];for(let e=0;e<u.length;e+=1)c[e]=U(P(t,u,e));return{c(){e=m("label"),e.textContent="Metric",n=p(),o=m("select");for(let t=0;t<c.length;t+=1)c[t].c();v(e,"for","metric-select"),v(e,"class","svelte-19uuc02"),v(o,"id","metric-select"),v(o,"class","svelte-19uuc02"),void 0===t[3]&&M(()=>t[9].call(o))},m(l,u){a(l,e,u),a(l,n,u),a(l,o,u);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(o,null);y(o,t[3],!0),r||(i=[g(o,"change",t[8]),g(o,"change",t[9])],r=!0)},p(t,e){if(48&e[0]){let n;for(u=A(t[5]),n=0;n<u.length;n+=1){const r=P(t,u,n);c[n]?c[n].p(r,e):(c[n]=U(r),c[n].c(),c[n].m(o,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=u.length}40&e[0]&&y(o,t[3])},d(t){t&&(f(e),f(n),f(o)),d(c,t),r=!1,l(i)}}}function U(t){let e,n,o,r=t[4][t[33]].label+"";return{c(){e=m("option"),n=h(r),e.__value=o=t[33],b(e,e.__value)},m(t,o){a(t,e,o),c(e,n)},p(t,l){48&l[0]&&r!==(r=t[4][t[33]].label+"")&&$(n,r),32&l[0]&&o!==(o=t[33])&&(e.__value=o,b(e,e.__value))},d(t){t&&f(e)}}}function G(t){let e,n,o,r=ot(t[2])+"";return{c(){e=m("p"),n=h("Last refreshed: "),o=h(r),v(e,"class","status svelte-19uuc02")},m(t,r){a(t,e,r),c(e,n),c(e,o)},p(t,e){4&e[0]&&r!==(r=ot(t[2])+"")&&$(o,r)},d(t){t&&f(e)}}}function H(t){let e,n,o;return{c(){e=m("p"),n=h("Failed to load data: "),o=h(t[1]),v(e,"class","status error svelte-19uuc02")},m(t,r){a(t,e,r),c(e,n),c(e,o)},p(t,e){2&e[0]&&$(o,t[1])},d(t){t&&f(e)}}}function V(t){let e;return{c(){e=m("p"),e.textContent="Loading latest data...",v(e,"class","status svelte-19uuc02")},m(t,n){a(t,e,n)},p:n,d(t){t&&f(e)}}}function Z(t){let e,n,o,r,l,i=t[7]?" ("+t[7]+")":"",u=A(t[6]),s=[];for(let e=0;e<u.length;e+=1)s[e]=X(K(t,u,e));return{c(){e=m("div"),n=m("div"),o=h("Legend"),r=h(i),l=p();for(let t=0;t<s.length;t+=1)s[t].c();v(n,"class","legend-title svelte-19uuc02"),v(e,"class","legend svelte-19uuc02")},m(t,i){a(t,e,i),c(e,n),c(n,o),c(n,r),c(e,l);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,null)},p(t,n){if(128&n[0]&&i!==(i=t[7]?" ("+t[7]+")":"")&&$(r,i),64&n[0]){let o;for(u=A(t[6]),o=0;o<u.length;o+=1){const r=K(t,u,o);s[o]?s[o].p(r,n):(s[o]=X(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=u.length}},d(t){t&&f(e),d(s,t)}}}function Q(t){let e,n,o,r,l,i,u,s=t[30].label+"";return{c(){e=m("div"),n=m("span"),r=p(),l=m("span"),i=h(s),u=p(),v(n,"class","legend-swatch svelte-19uuc02"),v(n,"style",o=`background:${t[30].color}`),v(e,"class","legend-row svelte-19uuc02")},m(t,o){a(t,e,o),c(e,n),c(e,r),c(e,l),c(l,i),c(e,u)},p(t,e){64&e[0]&&o!==(o=`background:${t[30].color}`)&&v(n,"style",o),64&e[0]&&s!==(s=t[30].label+"")&&$(i,s)},d(t){t&&f(e)}}}function X(t){let e,n=t[30].label&&Q(t);return{c(){n&&n.c(),e=h("")},m(t,o){n&&n.m(t,o),a(t,e,o)},p(t,o){t[30].label?n?n.p(t,o):(n=Q(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){t&&f(e),n&&n.d(t)}}}function Y(t){let e,o,r,l,i,u,s,d,g,$,b,y,_,w=t[5].length&&J(t);function x(t,e){return t[0]?V:t[1]?H:t[2]?G:void 0}let N=x(t),E=N&&N(t),k=t[6].length&&Z(t);return{c(){e=m("section"),o=m("h1"),o.textContent="KNMI Solar Radiation",r=p(),l=m("p"),l.textContent="Overlay KNMI 10 minute irradiance averaged per Dutch region.",i=p(),w&&w.c(),u=p(),E&&E.c(),s=p(),k&&k.c(),d=p(),g=m("p"),$=h("Source: "),b=m("a"),y=h("GeoJSON feed"),_=h(". Data refreshes every 10 minutes."),v(o,"class","svelte-19uuc02"),v(l,"class","intro svelte-19uuc02"),v(b,"href",tt),v(b,"target","_blank"),v(b,"rel","noopener"),v(b,"class","svelte-19uuc02"),v(g,"class","footer svelte-19uuc02"),v(e,"class","svelte-19uuc02")},m(t,n){a(t,e,n),c(e,o),c(e,r),c(e,l),c(e,i),w&&w.m(e,null),c(e,u),E&&E.m(e,null),c(e,s),k&&k.m(e,null),c(e,d),c(e,g),c(g,$),c(g,b),c(b,y),c(g,_)},p(t,n){t[5].length?w?w.p(t,n):(w=J(t),w.c(),w.m(e,u)):w&&(w.d(1),w=null),N===(N=x(t))&&E?E.p(t,n):(E&&E.d(1),E=N&&N(t),E&&(E.c(),E.m(e,s))),t[6].length?k?k.p(t,n):(k=Z(t),k.c(),k.m(e,d)):k&&(k.d(1),k=null)},i:n,o:n,d(t){t&&f(e),w&&w.d(),E&&E.d(),k&&k.d()}}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const tt="https://raw.githubusercontent.com/artis-byte/NL-solar/main/qg_regions.geojson",et="qg_mean";function nt(t){if("number"!=typeof t||!Number.isFinite(t))return"n/a";const e=Math.abs(t);return e>=1e3||e>=100?t.toFixed(0):e>=10?t.toFixed(1):e>=1?t.toFixed(2):0===e?"0":t.toPrecision(2)}function ot(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function rt(t,n,o){const r=["#800026","#BD0026","#E31A1C","#FC4E2A","#FD8D3C","#FEB24C","#FED976","#FFEDA0"],l={qg_mean:"Mean global irradiance (qg)",estimated_output_mw:"Estimated PV output",solar_capacity_mw:"Installed solar capacity"},i={qg_mean:"W/m^2",estimated_output_mw:"MW",solar_capacity_mw:"MW"};let u=null,c=null,s=null,a=null,f=null,d=!1,m="",h="",p=et,g={},v=[],$=[],b="",y=null;function _(){return!!e&&(u=e,"function"==typeof u.addLayer)}function w(){return c||"undefined"==typeof window||(c=window.L||null),c}function N(t,e){if("qg_mean"===t)return[800,600,400,200,100,50,10];const n=r.length-1,o=e.min,l=e.max;if(!Number.isFinite(o)||!Number.isFinite(l)||l<=o)return[];const i=l-o,u=[];for(let t=n;t>=1;t-=1)u.push(o+i*t/n);return u}function E(t,e){if("number"!=typeof t||!Number.isFinite(t))return"#7f7f7f";if(!e.length)return r[Math.floor(r.length/2)];for(let n=0;n<e.length;n+=1)if(t>=e[n])return r[n];return r[r.length-1]}function k(){s&&w()&&("function"==typeof s.remove?s.remove():u&&"function"==typeof u.removeLayer&&u.removeLayer(s),s=null)}function F(t){if(!t)return void k();const e=g[p];if(!e)return o(1,m="No numeric metric found in dataset."),void k();const n=w();if(!n)return o(1,m="Leaflet library is not available in Windy."),void k();_()&&(k(),o(6,$=function(t,e){const n=[],o=i[e]||"";for(let e=0;e<r.length;e+=1){let l;l=t.length?0===e?`>= ${nt(t[0])}`:e===r.length-1?`< ${nt(t[t.length-1])}`:`${nt(t[e-1])} - ${nt(t[e])}`:0===e?"Higher values":e===r.length-1?"Lower values":"",o&&l&&"Higher values"!==l&&"Lower values"!==l&&(l=`${l} ${o}`),n.push({color:r[e],label:l})}return n}(e.thresholds,p)),o(7,b=e.units||""),s=n.geoJSON(t,{style:t=>({fillColor:E((t?.properties||{})[p],e.thresholds),fillOpacity:.6,weight:1,color:"#333333"}),onEachFeature:(t,e)=>{const n=function(t){const e=t?.properties||{},n=[],o=e.name||e.station||"Region";n.push(`<strong>${o}</strong>`);const r=g[p];if(r){const t=e[p],o=r.units?` ${r.units}`:"";n.push(`${r.label}: ${nt(t)}${o}`)}const u=["estimated_output_mw","solar_capacity_mw"];for(const t of u){if(t===p)continue;const o=e[t];if("number"==typeof o&&Number.isFinite(o)){const e=i[t]?` ${i[t]}`:"",r=l[t]||t;n.push(`${r}: ${nt(o)}${e}`)}}return n.join("<br>")}(t);n&&e.bindPopup(n)}}),"function"==typeof s.addTo?s.addTo(u):"function"==typeof u.addLayer?u.addLayer(s):(o(1,m="Unable to attach layer to Windy map."),s=null))}async function L(){o(0,d=!0),o(1,m="");try{const t=await fetch(`${tt}?t=${Date.now()}`,{cache:"no-store"});if(!t.ok)throw new Error(`Request failed (${t.status})`);const e=await t.json();if(y=e,o(4,g=function(t){const e=Array.isArray(t?.features)?t.features:[],n={};for(const t of e){const e=t&&t.properties;if(e)for(const[t,o]of Object.entries(e))"number"==typeof o&&Number.isFinite(o)&&"level"!==t&&(n[t]||(n[t]=[]),n[t].push(o))}const o={};for(const[t,e]of Object.entries(n)){if(!e.length)continue;const n=e.reduce((t,e)=>Math.min(t,e),e[0]),r=e.reduce((t,e)=>Math.max(t,e),e[0]);o[t]={key:t,label:l[t]||t,units:i[t]||"",min:n,max:r,thresholds:N(t,{min:n,max:r})}}return o}(e)),o(5,v=Object.keys(g)),!v.length)throw new Error("GeoJSON does not contain numeric metrics.");g[p]||o(3,p=g[et]?et:v[0]),F(e),o(2,h=(new Date).toISOString())}catch(t){console.error("Failed to load KNMI data",t),o(1,m=t?.message||String(t)),y=null,o(4,g={}),o(5,v=[]),o(6,$=[]),o(7,b=""),k()}finally{o(0,d=!1)}}var I;return I=()=>{w(),_(),L(),a=setInterval(L,6e5),f||(f=setInterval(()=>{!u&&_()&&y&&(F(y),clearInterval(f),f=null)},1e3))},x().$$.on_mount.push(I),function(t){x().$$.on_destroy.push(t)}(()=>{a&&(clearInterval(a),a=null),f&&(clearInterval(f),f=null),k()}),[d,m,h,p,g,v,$,b,function(t){o(3,p=t.currentTarget.value),F(y)},function(){p=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),o(3,p),o(5,v)}]}class lt extends z{constructor(t){super(),T(this,t,rt,Y,u,{},B,[-1,-1])}}export{t as __pluginConfig,lt as default};
