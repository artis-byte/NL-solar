const t={name:"windy-plugin-knmi-qg-regions",version:"0.2.0",icon:"â˜€",title:"KNMI Solar Radiation",description:"Overlay KNMI 10 minute irradiance (qg) averaged per Dutch region.",author:"Artis Byte",repository:"https://github.com/artis-byte/NL-solar",desktopUI:"rhpane",mobileUI:"fullscreen",routerPath:"/knmi-solar",private:!1,built:1760114922390,builtReadable:"2025-10-10T16:48:42.390Z",screenshot:"screenshot.jpg"};import*as e from"leaflet";function n(){}function o(t){return t()}function r(){return Object.create(null)}function l(t){t.forEach(o)}function u(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){t.appendChild(e)}function s(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=m("style");t.id=e,t.textContent=n,function(t,e){c(t.head||t,e),e.sheet}(o,t)}}function a(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function g(){return h(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}function y(t,e,n){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}let _;function w(t){_=t}function x(){if(!_)throw new Error("Function called outside component initialization");return _}const N=[],E=[];let k=[];const F=[],I=Promise.resolve();let M=!1;function O(t){k.push(t)}const S=new Set;let D=0;function C(){if(0!==D)return;const t=_;do{try{for(;D<N.length;){const t=N[D];D++,w(t),q(t.$$)}}catch(t){throw N.length=0,D=0,t}for(w(null),N.length=0,D=0;E.length;)E.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];S.has(e)||(S.add(e),e())}k.length=0}while(N.length);for(;F.length;)F.pop()();M=!1,S.clear(),w(t)}function q(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const A=new Set;function L(t){return void 0!==t?.length?t:Array.from(t)}function j(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];k.forEach(o=>-1===t.indexOf(o)?e.push(o):n.push(o)),n.forEach(t=>t()),k=e}(n.after_update),l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(N.push(t),M||(M=!0,I.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function z(t,e,i,c,s,a,d=null,m=[-1]){const h=_;w(t);const g=t.$$={fragment:null,ctx:[],props:a,update:n,not_equal:s,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:r(),dirty:m,skip_bound:!1,root:e.target||h.$$.root};d&&d(g.root);let p=!1;if(g.ctx=i?i(t,e.props||{},(e,n,...o)=>{const r=o.length?o[0]:n;return g.ctx&&s(g.ctx[e],g.ctx[e]=r)&&(!g.skip_bound&&g.bound[e]&&g.bound[e](r),p&&R(t,e)),n}):[],g.update(),p=!0,l(g.before_update),g.fragment=!!c&&c(g.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);g.fragment&&g.fragment.l(t),t.forEach(f)}else g.fragment&&g.fragment.c();e.intro&&((v=t.$$.fragment)&&v.i&&(A.delete(v),v.i($))),function(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),O(()=>{const e=t.$$.on_mount.map(o).filter(u);t.$$.on_destroy?t.$$.on_destroy.push(...e):l(e),t.$$.on_mount=[]}),i.forEach(O)}(t,e.target,e.anchor),C()}var v,$;w(h)}class B{$$=void 0;$$set=void 0;$destroy(){j(this,1),this.$destroy=n}$on(t,e){if(!u(e))return n;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function K(t){s(t,"svelte-19uuc02","section.svelte-19uuc02{padding:0.75em;max-width:320px;font-family:sans-serif;font-size:0.9em;line-height:1.4}h1.svelte-19uuc02{font-size:1.2em;margin:0 0 0.4em}p.intro.svelte-19uuc02{margin:0 0 0.75em}label.svelte-19uuc02{display:block;margin:0.75em 0 0.25em;font-weight:600}select.svelte-19uuc02{width:100%;padding:0.3em;margin-top:0.25em}.status.svelte-19uuc02{margin:0.75em 0 0}.status.error.svelte-19uuc02{color:#b03a2e}.legend.svelte-19uuc02{margin-top:1em;border-top:1px solid #dddddd;padding-top:0.75em}.legend-title.svelte-19uuc02{font-weight:600;margin-bottom:0.4em}.legend-row.svelte-19uuc02{display:flex;align-items:center;margin-bottom:0.25em}.legend-swatch.svelte-19uuc02{width:18px;height:12px;margin-right:0.5em;border:1px solid #333333;box-sizing:border-box}.footer.svelte-19uuc02{margin-top:1em;font-size:0.8em;color:#555555}a.svelte-19uuc02{color:#0066cc}")}function P(t,e,n){const o=t.slice();return o[27]=e[n],o}function T(t,e,n){const o=t.slice();return o[30]=e[n],o}function W(t){let e,n,o,r,u,i=L(t[5]),c=[];for(let e=0;e<i.length;e+=1)c[e]=J(T(t,i,e));return{c(){e=m("label"),e.textContent="Metric",n=g(),o=m("select");for(let t=0;t<c.length;t+=1)c[t].c();v(e,"for","metric-select"),v(e,"class","svelte-19uuc02"),v(o,"id","metric-select"),v(o,"class","svelte-19uuc02"),void 0===t[3]&&O(()=>t[9].call(o))},m(l,i){a(l,e,i),a(l,n,i),a(l,o,i);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(o,null);y(o,t[3],!0),r||(u=[p(o,"change",t[8]),p(o,"change",t[9])],r=!0)},p(t,e){if(48&e[0]){let n;for(i=L(t[5]),n=0;n<i.length;n+=1){const r=T(t,i,n);c[n]?c[n].p(r,e):(c[n]=J(r),c[n].c(),c[n].m(o,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=i.length}40&e[0]&&y(o,t[3])},d(t){t&&(f(e),f(n),f(o)),d(c,t),r=!1,l(u)}}}function J(t){let e,n,o,r=t[4][t[30]].label+"";return{c(){e=m("option"),n=h(r),e.__value=o=t[30],b(e,e.__value)},m(t,o){a(t,e,o),c(e,n)},p(t,l){48&l[0]&&r!==(r=t[4][t[30]].label+"")&&$(n,r),32&l[0]&&o!==(o=t[30])&&(e.__value=o,b(e,e.__value))},d(t){t&&f(e)}}}function G(t){let e,n,o,r=nt(t[2])+"";return{c(){e=m("p"),n=h("Last refreshed: "),o=h(r),v(e,"class","status svelte-19uuc02")},m(t,r){a(t,e,r),c(e,n),c(e,o)},p(t,e){4&e[0]&&r!==(r=nt(t[2])+"")&&$(o,r)},d(t){t&&f(e)}}}function H(t){let e,n,o;return{c(){e=m("p"),n=h("Failed to load data: "),o=h(t[1]),v(e,"class","status error svelte-19uuc02")},m(t,r){a(t,e,r),c(e,n),c(e,o)},p(t,e){2&e[0]&&$(o,t[1])},d(t){t&&f(e)}}}function U(t){let e;return{c(){e=m("p"),e.textContent="Loading latest data...",v(e,"class","status svelte-19uuc02")},m(t,n){a(t,e,n)},p:n,d(t){t&&f(e)}}}function V(t){let e,n,o,r,l,u=t[7]?" ("+t[7]+")":"",i=L(t[6]),s=[];for(let e=0;e<i.length;e+=1)s[e]=Q(P(t,i,e));return{c(){e=m("div"),n=m("div"),o=h("Legend"),r=h(u),l=g();for(let t=0;t<s.length;t+=1)s[t].c();v(n,"class","legend-title svelte-19uuc02"),v(e,"class","legend svelte-19uuc02")},m(t,u){a(t,e,u),c(e,n),c(n,o),c(n,r),c(e,l);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,null)},p(t,n){if(128&n[0]&&u!==(u=t[7]?" ("+t[7]+")":"")&&$(r,u),64&n[0]){let o;for(i=L(t[6]),o=0;o<i.length;o+=1){const r=P(t,i,o);s[o]?s[o].p(r,n):(s[o]=Q(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},d(t){t&&f(e),d(s,t)}}}function Z(t){let e,n,o,r,l,u,i,s=t[27].label+"";return{c(){e=m("div"),n=m("span"),r=g(),l=m("span"),u=h(s),i=g(),v(n,"class","legend-swatch svelte-19uuc02"),v(n,"style",o=`background:${t[27].color}`),v(e,"class","legend-row svelte-19uuc02")},m(t,o){a(t,e,o),c(e,n),c(e,r),c(e,l),c(l,u),c(e,i)},p(t,e){64&e[0]&&o!==(o=`background:${t[27].color}`)&&v(n,"style",o),64&e[0]&&s!==(s=t[27].label+"")&&$(u,s)},d(t){t&&f(e)}}}function Q(t){let e,n=t[27].label&&Z(t);return{c(){n&&n.c(),e=h("")},m(t,o){n&&n.m(t,o),a(t,e,o)},p(t,o){t[27].label?n?n.p(t,o):(n=Z(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){t&&f(e),n&&n.d(t)}}}function X(t){let e,o,r,l,u,i,s,d,p,$,b,y,_,w=t[5].length&&W(t);function x(t,e){return t[0]?U:t[1]?H:t[2]?G:void 0}let N=x(t),E=N&&N(t),k=t[6].length&&V(t);return{c(){e=m("section"),o=m("h1"),o.textContent="KNMI Solar Radiation",r=g(),l=m("p"),l.textContent="Overlay KNMI 10 minute irradiance averaged per Dutch region.",u=g(),w&&w.c(),i=g(),E&&E.c(),s=g(),k&&k.c(),d=g(),p=m("p"),$=h("Source: "),b=m("a"),y=h("GeoJSON feed"),_=h(". Data refreshes every 10 minutes."),v(o,"class","svelte-19uuc02"),v(l,"class","intro svelte-19uuc02"),v(b,"href",Y),v(b,"target","_blank"),v(b,"rel","noopener"),v(b,"class","svelte-19uuc02"),v(p,"class","footer svelte-19uuc02"),v(e,"class","svelte-19uuc02")},m(t,n){a(t,e,n),c(e,o),c(e,r),c(e,l),c(e,u),w&&w.m(e,null),c(e,i),E&&E.m(e,null),c(e,s),k&&k.m(e,null),c(e,d),c(e,p),c(p,$),c(p,b),c(b,y),c(p,_)},p(t,n){t[5].length?w?w.p(t,n):(w=W(t),w.c(),w.m(e,i)):w&&(w.d(1),w=null),N===(N=x(t))&&E?E.p(t,n):(E&&E.d(1),E=N&&N(t),E&&(E.c(),E.m(e,s))),t[6].length?k?k.p(t,n):(k=V(t),k.c(),k.m(e,d)):k&&(k.d(1),k=null)},i:n,o:n,d(t){t&&f(e),w&&w.d(),E&&E.d(),k&&k.d()}}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const Y="https://raw.githubusercontent.com/artis-byte/NL-solar/main/qg_regions.geojson",tt="qg_mean";function et(t){if("number"!=typeof t||!Number.isFinite(t))return"n/a";const e=Math.abs(t);return e>=1e3||e>=100?t.toFixed(0):e>=10?t.toFixed(1):e>=1?t.toFixed(2):0===e?"0":t.toPrecision(2)}function nt(t){if(!t)return"";const e=new Date(t);return Number.isNaN(e.getTime())?t:e.toLocaleString()}function ot(t,n,o){const r=["#800026","#BD0026","#E31A1C","#FC4E2A","#FD8D3C","#FEB24C","#FED976","#FFEDA0"],l={qg_mean:"Mean global irradiance (qg)",estimated_output_mw:"Estimated PV output",solar_capacity_mw:"Installed solar capacity"},u={qg_mean:"W/m^2",estimated_output_mw:"MW",solar_capacity_mw:"MW"};let i=null,c=null,s=null,a=null,f=!1,d="",m="",h=tt,g={},p=[],v=[],$="",b=null;function y(){const t=function(){const t="undefined"!=typeof window?window.W:null;return t&&t.map?t.map:null}();return!!t&&(i=t,!0)}function _(t,e){if("qg_mean"===t)return[800,600,400,200,100,50,10];const n=r.length-1,o=e.min,l=e.max;if(!Number.isFinite(o)||!Number.isFinite(l)||l<=o)return[];const u=l-o,i=[];for(let t=n;t>=1;t-=1)i.push(o+u*t/n);return i}function w(t,e){if("number"!=typeof t||!Number.isFinite(t))return"#7f7f7f";if(!e.length)return r[Math.floor(r.length/2)];for(let n=0;n<e.length;n+=1)if(t>=e[n])return r[n];return r[r.length-1]}function N(){c&&i&&(i.removeLayer(c),c=null)}function E(t){if(!t)return void N();const n=g[h];if(!n)return o(1,d="No numeric metric found in dataset."),void N();y()&&(N(),o(6,v=function(t,e){const n=[],o=u[e]||"";for(let e=0;e<r.length;e+=1){let l;l=t.length?0===e?`>= ${et(t[0])}`:e===r.length-1?`< ${et(t[t.length-1])}`:`${et(t[e-1])} - ${et(t[e])}`:0===e?"Higher values":e===r.length-1?"Lower values":"",o&&l&&"Higher values"!==l&&"Lower values"!==l&&(l=`${l} ${o}`),n.push({color:r[e],label:l})}return n}(n.thresholds,h)),o(7,$=n.units||""),c=e.geoJSON(t,{style:t=>({fillColor:w((t?.properties||{})[h],n.thresholds),fillOpacity:.6,weight:1,color:"#333333"}),onEachFeature:(t,e)=>{const n=function(t){const e=t?.properties||{},n=[],o=e.name||e.station||"Region";n.push(`<strong>${o}</strong>`);const r=g[h];if(r){const t=e[h],o=r.units?` ${r.units}`:"";n.push(`${r.label}: ${et(t)}${o}`)}const i=["estimated_output_mw","solar_capacity_mw"];for(const t of i){if(t===h)continue;const o=e[t];if("number"==typeof o&&Number.isFinite(o)){const e=u[t]?` ${u[t]}`:"",r=l[t]||t;n.push(`${r}: ${et(o)}${e}`)}}return n.join("<br>")}(t);n&&e.bindPopup(n)}}).addTo(i))}async function k(){o(0,f=!0),o(1,d="");try{const t=await fetch(`${Y}?t=${Date.now()}`,{cache:"no-store"});if(!t.ok)throw new Error(`Request failed (${t.status})`);const e=await t.json();if(b=e,o(4,g=function(t){const e=Array.isArray(t?.features)?t.features:[],n={};for(const t of e){const e=t&&t.properties;if(e)for(const[t,o]of Object.entries(e))"number"==typeof o&&Number.isFinite(o)&&"level"!==t&&(n[t]||(n[t]=[]),n[t].push(o))}const o={};for(const[t,e]of Object.entries(n)){if(!e.length)continue;const n=e.reduce((t,e)=>Math.min(t,e),e[0]),r=e.reduce((t,e)=>Math.max(t,e),e[0]);o[t]={key:t,label:l[t]||t,units:u[t]||"",min:n,max:r,thresholds:_(t,{min:n,max:r})}}return o}(e)),o(5,p=Object.keys(g)),!p.length)throw new Error("GeoJSON does not contain numeric metrics.");g[h]||o(3,h=g[tt]?tt:p[0]),E(e),o(2,m=(new Date).toISOString())}catch(t){console.error("Failed to load KNMI data",t),o(1,d=t?.message||String(t)),b=null,o(4,g={}),o(5,p=[]),o(6,v=[]),o(7,$=""),N()}finally{o(0,f=!1)}}var F;return F=()=>{y(),k(),s=setInterval(k,6e5),a||(a=setInterval(()=>{!i&&y()&&b&&(E(b),clearInterval(a),a=null)},1e3))},x().$$.on_mount.push(F),function(t){x().$$.on_destroy.push(t)}(()=>{s&&(clearInterval(s),s=null),a&&(clearInterval(a),a=null),N()}),[f,d,m,h,g,p,v,$,function(t){o(3,h=t.currentTarget.value),E(b)},function(){h=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),o(3,h),o(5,p)}]}class rt extends B{constructor(t){super(),z(this,t,ot,X,i,{},K,[-1,-1])}}export{t as __pluginConfig,rt as default};
